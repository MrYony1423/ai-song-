<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Funny TTS App</title>
  <style>
    * { box-sizing: border-box; margin:0; padding:0; }
    body {
      font-family: Arial, sans-serif;
      background:#121212; color:white;
      display:flex; flex-direction:column; align-items:center;
      min-height:100vh; padding:20px;
    }
    .app { max-width:400px; width:100%; }
    h2 { margin:15px 0; text-align:center;}
    input, select, textarea, button {
      width:100%; margin:8px 0; padding:12px;
      border-radius:6px; border:none; font-size:16px;
    }
    textarea { height:100px; }
    button { background:#00aaff; color:#fff; cursor:pointer; }
    button:hover { background:#0088cc; }
    #avatar { width:40px; height:40px; border-radius:50%; background:#00aaff;
      color:#fff; display:flex; align-items:center; justify-content:center;
      font-size:20px; position:absolute; top:20px; right:20px;
    }
    .history { background:#222; padding:10px; margin:10px 0; border-radius:6px; max-height:150px; overflow:auto;}
    .history p { margin:5px 0; font-size:14px; }
  </style>
</head>
<body>
  <div id="avatar" style="display:none"></div>
  <div class="app">
    <h2 id="title">住 拽住 专</h2>

    <div id="auth">
      <input id="name" placeholder="砖 " />
      <input id="email" placeholder="" />
      <input id="phone" placeholder="驻" />
      <input id="password" type="password" placeholder="住住" />
      <button id="registerBtn">专砖 / 住</button>
    </div>

    <div id="mainUI" style="display:none">
      <select id="character">
        <option value="base"> 住住</option>
        <option value="pizza"> 砖 驻爪</option>
        <option value="robot"> 专</option>
        <option value="baby"> 转拽</option>
        <option value="girl"> </option>
        <option value="deepman"> 拽 注拽</option>
      </select>

      <textarea id="textInput" placeholder="转 ..."></textarea>
      <button id="speakBtn"> 专</button>
      <div class="history" id="history"></div>
    </div>
  </div>

<script>
  const characterSettings = {
    base:{pitch:1, rate:1},
    pizza:{pitch:1.3, rate:1.2},
    robot:{pitch:1, rate:0.8},
    baby:{pitch:2.0, rate:1.5},
    girl:{pitch:1.6, rate:1.2},
    deepman:{pitch:0.6, rate:0.9}
  };

  function saveUser(user){
    localStorage.setItem('ttsUser', JSON.stringify(user));
  }
  function loadUser(){
    return JSON.parse(localStorage.getItem('ttsUser')||'null');
  }

  function renderAvatar(name){
    const av = document.getElementById('avatar');
    av.textContent = name.charAt(0);
    av.style.display='flex';
  }

  function addHistory(text){
    const hist = document.getElementById('history');
    const p = document.createElement('p');
    p.textContent = text;
    hist.prepend(p);
  }

  document.getElementById('registerBtn').onclick = ()=>{
    const u = {
      name: document.getElementById('name').value,
      email: document.getElementById('email').value,
      phone: document.getElementById('phone').value,
      password: document.getElementById('password').value,
    };
    if(!u.name||!u.email||!u.phone||!u.password){
      alert(' 转  砖转!');
      return;
    }
    saveUser(u);
    document.getElementById('auth').style.display='none';
    document.getElementById('mainUI').style.display='block';
    renderAvatar(u.name);
  };

  window.onload = ()=>{
    const u = loadUser();
    if(u){
      document.getElementById('auth').style.display='none';
      document.getElementById('mainUI').style.display='block';
      renderAvatar(u.name);
    }
  };

  document.getElementById('speakBtn').onclick = ()=>{
    const txt = document.getElementById('textInput').value.trim();
    if(!txt) return alert('转 砖...');
    const ch = document.getElementById('character').value;
    const {pitch, rate} = characterSettings[ch]||characterSettings.base;
    const ut = new SpeechSynthesisUtterance(txt);
    ut.pitch = pitch; ut.rate = rate;
    const lang = 'he-IL';
    ut.lang = lang;
    const voices = speechSynthesis.getVoices();
    ut.voice = voices.find(v=>v.lang.startsWith('he')) || voices[0];
    speechSynthesis.cancel(); speechSynthesis.speak(ut);
    addHistory(txt);
  };
</script>
</body>
</html>
